<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="elements/barstat-element.html">
<link rel="import" href="../bower_components/google-chart/google-chart.html">
<dom-module name="graph-stats">
  <template>
  	<style>
    :host {
      width: 100%;
    }
    google-chart {
      height: 800px;
      width: 800px;
    }
    #selection-demo {
      position: relative;
    }
    #selection-chart {
      float: left;
    }

    #selection-display {
      display: inline-block;
      position: relative;
      top: 50%;
    }
  	</style>
    <div class="layout vertical center">

      <template is="dom-repeat" items="{{optionwise}}">
        <barstat-element heading="{{item.0}}" barcolor="{{getColorCode(index)}}" barvalue="{{item.1}}"></barstat-element>
      </template>

      <div id="selection-demo">
        <google-chart
          type="pie"
          id="selection-chart"
          options='{"title": "Distribution of Answers"}'
          cols='[{"label": "Answer", "type": "string"},{"label": "Count", "type": "number"}]'
          rows='{{responsewise}}'>
        </google-chart>
        <div id="selection-display">
          Selected row: <span id="selection-label">None</span>.
        </div>
      </div>

      <script>
        document.addEventListener('WebComponentsReady', function() {
          var chart = document.querySelector('#selection-chart');
          var label = document.querySelector('#selection-label');
          chart.drawChart();
          chart.addEventListener('google-chart-render', function() {
            chart.selection = [{row: 1, column: null}];
            label.textContent = chart.selection[0].row;
          });

          document.addEventListener('google-chart-select', function(e) {
            label.textContent =
                chart.selection[0] ? chart.selection[0].row : 'None';
          });
        });
      </script>
    </div>
  </template>
  <script>
  	Polymer({
      is: "graph-stats",
      properties: {
        optionwise: { type: Array, value: [['Bar1','50'],['Bar2','30']]},
        responsewise: { type: Array, value: [ ['Ans1', 50],['Ans2', 30],['Ans3', 20] ]},
        data : { type: Array, value: [] }
      },
      getColorCode: function(ind){
        var availcolors = ['primary', 'success', 'info','warning','danger','grey'];
        return availcolors[ind%6];
      }
  	});
  </script>
</dom-module>