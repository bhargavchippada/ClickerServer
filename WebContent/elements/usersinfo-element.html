<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<polymer-element name="usersinfo-element">
  <template>
  	<style>
    :host{
      display: block;
      margin:16px 0 0 0;
    }
    #rowheadings {
      font-weight: 800;
    }
    table {
      width: 100%;
      border-collapse: collapse; 
    }
    tr.border_top {
      width: 100%;
      border-top: 1px solid black;
    }
    td,th {
      text-align: center;
      width: 20%;
      padding: 8px 0 8px 0;
    }
    .label {
      color: #fff;
      padding: 4px;
      border-radius: 4px;
    }
    .bgcolor-success {
      background-color: #5CB85C;
    }
    .bgcolor-danger {
      background-color: #D9534F;
    }
    .bgcolor-info {
      background-color: #5bc0de;
    }
    .bgcolor-warning {
      background-color: #f0ad4e;
    }
    .bgcolor-primary {
      background-color: #337ab7;
    }
    .color-success {
      color: #5CB85C;
    }
    .color-danger {
      color: #D9534F;
    }
    .color-info {
      color: #5bc0de;
    }
    .color-warning {
      color: #f0ad4e;
    }
    .color-primary {
      color: #337ab7;
    }
    input {
      width: 80%;
    }
    .thinput {
      padding: 0 0 8px 0;
    }
	  </style>
    <table>
      <thead>
        <tr class="border_top">
          <th id="0" on-click="{{changeSort}}" style="{{sortColumn == '0' ? (sortDescending ? 'text-decoration:overline' : 'text-decoration:underline') : ''}}">Roll-number</th>
          <th id="1" on-click="{{changeSort}}" style="{{sortColumn == '1' ? (sortDescending ? 'text-decoration:overline' : 'text-decoration:underline') : ''}}">Name</th>
          <th id="2" on-click="{{changeSort}}" style="{{sortColumn == '2' ? (sortDescending ? 'text-decoration:overline' : 'text-decoration:underline') : ''}}">Answer</th>
          <th id="3" on-click="{{changeSort}}" style="{{sortColumn == '3' ? (sortDescending ? 'text-decoration:overline' : 'text-decoration:underline') : ''}}">Status</th>
          <th id="4" on-click="{{changeSort}}" style="{{sortColumn == '4' ? (sortDescending ? 'text-decoration:overline' : 'text-decoration:underline') : ''}}">Last-Update</th>
        </tr>
        <tr>
          <th class="thinput"><input type="search" value="{{value0}}"/></th>
          <th class="thinput"><input type="search" value="{{value1}}"/></th>
          <th class="thinput"><input type="search" value="{{value2}}"/></th>
          <th class="thinput"><input type="search" value="{{value3}}"/></th>
          <th class="thinput"><input type="search" value="{{value4}}"/></th>
        </tr>
      </thead>
      <tbody>
        <template id="usersinfotemplete" repeat="{{userinfo in usersdata | sortByKey(sortColumn, sortDescending)}}">
          <tr class="border_top" hidden?="{{hiddenornot(userinfo[0],userinfo[1],userinfo[2],userinfo[3],userinfo[4], value0, value1, value2, value3, value4)}}">
            <td>{{userinfo[0]}}</td>
            <td>{{userinfo[1]}}</td>
            <td><span class="color-success">{{userinfo[2]}}</span></td>
            <td><span class="label bgcolor-success">{{userinfo[3]}}</span></td>
            <td>{{userinfo[4]}}</td>
          </tr>
        </template>
      </tbody>
    </table>
    <paper-button on-click="{{addRow}}" raised>Click</paper-button>
  </template>
  <script>
    Polymer({
      usersdata:[["120050053","bhargav",[1,2],"connected","time"],["120050048","sundeep",[2,3],"done","time2"]],
      sortColumn:'0',
      sortDescending: true,
      value0:'',
      value1:'',
      value2:'',
      value3:'',
      value4:'',
      ready: function(){
      },
      addRow: function(){
        //this.usersdata.push(["120050069","sumanth",[1,3],"disconnected","time3"]);
        this.usersdata[1][1]="yo";
        //this.$.usersinfotemplete.iterator_.updateIteratedValue(); // Force Polymer to refresh template
      },
      changeSort: function(e,p,o){
        var clickedSortColumn = o.id;
        if(clickedSortColumn == this.sortColumn){
          //column already sorted, reverse sort
          this.sortDescending = !this.sortDescending;
        }else{
          this.sortColumn = clickedSortColumn;
        }
      },
      sortByKey : function(array, key, desc) {
        return array.sort(function(a, b) {
          var x = a[key];
          var y = b[key];
       
          if (typeof x == "string"){
            x = x.toLowerCase(); 
            y = y.toLowerCase();
          }
          if(desc){
            return ((x < y) ? 1 : ((x > y) ? -1 : 0));
          }else{
            return ((x < y) ? -1 : ((x > y) ? 1 : 0));
          }
        });
      },
      hiddenornot: function(userinfo0,userinfo1,userinfo2,userinfo3,userinfo4,value0,value1,value2,value3,value4){
        var b0 = value0=='' || JSON.stringify(userinfo0).indexOf(value0) > -1;
        var b1 = value1=='' || JSON.stringify(userinfo1).indexOf(value1) > -1;
        var b2 = value2=='' || JSON.stringify(userinfo2).indexOf(value2) > -1;
        var b3 = value3=='' || JSON.stringify(userinfo3).indexOf(value3) > -1;
        var b4 = value4=='' || JSON.stringify(userinfo4).indexOf(value4) > -1;
        console.log(b0,b1,b2,b3,b4);
        if(b0 && b1 && b2 && b3 && b4) return false;
        else return true;
      }
    })
  </script>
</polymer-element>